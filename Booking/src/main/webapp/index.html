<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="Cache-Control" content="no-store" />
    <title>Booking</title>

    <link href="bootstrap-4.5.2-dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="bootstrap-4.5.2-dist/js/jquery-slim.min.js"></script>
    <script src="bootstrap-4.5.2-dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">
    <link rel="stylesheet" href="css/stileindex.css">

</head>

<body>
    <div id="components">
        <span v-if="loginHome"><br><br><br><br><br>
            <login link="ServletController" v-on:creazione-inner="transit('creazione')" v-on:ospite-inner="transit('ospiteHome')" v-on:transit-inner-cliente="transit('clienteHome')" v-on:transit-inner-amministratore="transit('amministratoreHome')"></login>
        </span>

        <span v-if="creazionehome"><br>
            <br><br><br>
            <creazione link="ServletController" v-on:transit-inner-login="transit('loginHome')"></creazione>
        </span>

        <span v-if="homeCliente && role === 'Cliente'">
            <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
                <div class="container-fluid">
                    <a class="navbar-brand" href="https://www.unito.it/"  target="_blank">UniTO</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" aria-current="page" type="button" v-on:click="transit('clienteHome')">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" type="button" v-on:click="transit('mieprenotazioni')">Prenotazioni</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" type="button" v-on:click="transit('ripetizioni')">Ripetizioni</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="nav-item">
                    <a class="btn btn-warning" type="button" v-on:click="transit('logout')">Logout</a>
                </div>
            </nav>
            <hr>
            <!--HOME CLIENTE-->
            <home v-if="checkCl" v-on:transit-inner-prenotazioni="transit('mieprenotazioni')" v-on:transit-inner-corsi_docenti="transit('corsi_docenti')" v-on:transit-inner-ripetizioni="transit('ripetizioni')"></home>

            <!--SEZIONE STAMPA E AGGIUNTA DEI DATI-->
            <div class="container">
               <hr>
                <!--STAMPA DEI CORSI E DOCENTI-->
                <coursesteacher v-if="stampaCD" link="ServletController" v-on:transit-inner-logout="transit('logout2')"></coursesteacher>

                <!--STAMPA DELLE MIE PRENOTAZIONI-->
                <mybooking v-if="stampaMPr" link="ServletController" v-on:transit-inner-logout="transit('logout2')"></mybooking>

                <!--STAMPA DELLE RIPETIZIONI-->
                <repetition v-if="stampaR" link="ServletController" ospite="False" v-on:transit-inner-logout="transit('logout2')"></repetition>
            </div>
        </span>

        <span v-if="homeOspite && role === 'Ospite'">
            <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
                <div class="container-fluid">
                    <a class="navbar-brand" href="https://www.unito.it/"  target="_blank">UniTO</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav2">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" aria-current="page" type="button" v-on:click="transit('ospiteHome')">Home</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="nav-item">
                    <a class="btn btn-warning" type="button" v-on:click="transit('logout')">Logout</a>
                </div>
            </nav>
            <hr>
            <!-- HOME -->
            <home v-if="checkO"  v-on:transit-inner-corsi_docenti="transit('corsi_docenti')" v-on:transit-inner-ripetizioni="transit('ripetizioni')" v-on:transit-inner-prenotazioni="transit('alert')"></home>

            <!--SEZIONE STAMPA DEI DATI-->
            <div class="container">
               <hr>
                <coursesteacher v-if="stampaCD" link="ServletController" v-on:transit-inner-logout="transit('logout2')"></coursesteacher>

                <div v-if="stampaR">
                    <h4>Per prenotare le lezioni devi avere un account. Registrati e prenota!</h4>
                    <br>
                    <repetition link="ServletController" ospite="True" v-on:transit-inner-logout="transit('logout2')"></repetition>
                </div>
            </div>
        </span>

        <span v-if="homeAmministratore && role === 'Amministratore'">
            <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
                <div class="container-fluid">
                    <a class="navbar-brand" href="https://www.unito.it/"  target="_blank">UniTO</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav3">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" aria-current="page" type="button" v-on:click="transit('amministratoreHome')">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" type="button" v-on:click="transit('mieprenotazioni')">Prenotazioni</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" type="button" v-on:click="transit('ripetizioni')">Ripetizioni</a>
                            </li>
                        </ul>
                    </div>
                    <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Men&uacute; amministratore
                        </button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" >
                            <button class="dropdown-item"  v-on:click="transit('prenotazioni')">Le prenotazioni registrate</button><br>
                            <button class="dropdown-item" v-on:click="transit('gestioneCD')">Gestione di corsi e docenti</button><br>
                            <button class="dropdown-item" v-on:click="transit('gestioneR')">Gestione delle ripetizioni</button><br>
                            <button class="dropdown-item" v-on:click="transit('storico')">Storico</button>
                        </div>
                    </div>
                </div>
                <div class="nav-item">
                    <a class="btn btn-warning" type="button" v-on:click="transit('logout')">Logout</a>
                </div>
            </nav>
            <hr>
            <!--HOME AMMINISTRATORE-->
            <home v-if="checkAH" v-on:transit-inner-prenotazioni="transit('mieprenotazioni')" v-on:transit-inner-corsi_docenti="transit('corsi_docenti')" v-on:transit-inner-ripetizioni="transit('ripetizioni')"></home>

            <!--SEZIONE STAMPA E AGGIUNTA DEI DATI-->
            <!--STAMPA DEI CORSI E DOCENTI-->
            <coursesteacher v-if="stampaCD" link="ServletController" v-on:transit-inner-logout="transit('logout2')"></coursesteacher>

            <!--STAMPA DELLE RIPETIZIONI-->
            <repetition v-if="stampaR" link="ServletController" ospite="False" v-on:transit-inner-logout="transit('logout2')"></repetition>

            <!--STAMPA DELLE PRENOTAZIONI-->
            <booking v-if="stampaPr" link="ServletController" v-on:transit-inner-logout="transit('logout2')"></booking>

            <!--STAMPA DELLE MIE PRENOTAZIONI-->
            <mybooking v-if="stampaMPr" link="ServletController" v-on:transit-inner-logout="transit('logout2')"></mybooking>

            <!--AGGIUNTA DI CORSI E DOCENTI-->
            <admincoursesteacher v-if="gestioneCD" link="ServletController" v-on:transit-inner-logout="transit('logout2')"></admincoursesteacher>

            <!--AGGIUNTA DELLE RIPETIZIONI-->
            <adminrepetition v-if="gestioneR" link="ServletController" v-on:transit-inner-logout="transit('logout2')"></adminrepetition>

            <!--STAMPA STORICO-->
            <span v-if="storico">
                <h4>Storico dei corsi, docenti e ripetizioni</h4>
                <courses link="ServletController" storico="True" v-on:transit-inner-logout="transit('logout2')"></courses>
                <teacher link="ServletController" storico="True" v-on:transit-inner-logout="transit('logout2')"></teacher>
                <repetitionstorico link="ServletController" v-on:transit-inner-logout="transit('logout2')"></repetitionstorico>
            </span>
        </span>
    </div>

    <script>

        //Component login
        Vue.component('login',{
            data: function () {
                return{
                    em: null,
                    pass: null,
                    errore: false,
                }
            },
            props: ['link'],
            template: '<div class="container h-100">\n' +
                '                <div class="d-flex justify-content-center h-100">\n' +
                '                    <div class="user_card">\n' +
                '                        <div class="d-flex justify-content-center">\n' +
                '                            <div class="brand_logo_container">\n' +
                '                                <img src="img/logo.jpg" class="brand_logo" alt="Logo">\n' +
                '                            </div>\n' +
                '                        </div>\n' +
                '                        <br>\n' +
                '                        <div class="d-flex justify-content-center form_container">\n' +
                '                            <article class="form-group">\n' +
                '                                <div class="input-group mb-3">\n' +
                '                                    <div class="input-group-append">\n' +
                '                                        <span class="input-group-text"><i class="fas fa-user"></i></span>\n' +
                '                                    </div>\n' +
                '                                    <input v-model="em" type="text" class="form-control input_user" placeholder="Email">\n' +
                '                                </div>\n' +
                '                                <div class="input-group mb-2">\n' +
                '                                    <div class="input-group-append">\n' +
                '                                        <span class="input-group-text"><i class="fas fa-key"></i></span>\n' +
                '                                    </div>\n' +
                '                                        <input v-model="pass" type="password" class="form-control input_pass" placeholder="Password">\n' +
                '                                </div>\n' +
                '                                <div class="d-flex justify-content-center mt-3 login_container">\n' +
                '                                    <button v-on:click="ServletControllerPost(\'login\')" class="btn login_btn">Autentica </button>\n' +
                '                                </div>\n' +
                '                                <template v-if="errore">\n' +
                '                                    <span class="badge badge-danger">Errore nel login</span>\n' +
                '                                </template>\n' +
                '                                <br>\n' +
                '                                   <article class="d-flex justify-content-center links">' +
                '                                   <p>Non hai ancora un account? <button type="button" class="btn btn-outline-dark" v-on:click="transit(\'creazione\')"> Crea account</button>' +
                '                                   <br><br>Oppure entra come ospite&nbsp&nbsp&nbsp&nbsp<button type="button" class="btn btn-outline-dark" v-on:click="ServletControllerPost(\'ospite\')">Entra </button></p>' +
                '                                   </article>'+
                '                            </article>\n' +
                '                        </div>\n' +
                '                    </div>\n' +
                '                </div>\n' +
                '            </div>      ',
            methods: {
                ServletControllerPost: function (flag){
                    var self = this;
                    $.post(this.link, {action: flag, email: this.em, password: this.pass}, function (data) {
                        switch (flag){
                            case 'login':
                                switch (data) {
                                    case 'sono amministratore':
                                        self.errore = false; self.transit("amministratoreHome"); break;
                                    case 'sono cliente':
                                        self.errore = false; self.transit("clienteHome"); break;
                                    case 'errore':
                                        self.errore = true; break;
                                }
                                break;
                            case 'ospite':
                                self.transit("ospiteHome"); break;
                        }

                    })
                },
                transit: function (flag) {
                    switch (flag){
                        case "creazione":
                            this.$emit('creazione-inner'); break;
                        case "ospiteHome":
                            this.$emit('ospite-inner'); break;
                        case "amministratoreHome":
                            this.$emit('transit-inner-amministratore'); break;
                        case "clienteHome":
                            this.$emit('transit-inner-cliente'); break;
                    }
                },
            }
        })

        //Component creazione
        Vue.component('creazione',{
            data: function () {
                return{
                    em: null,
                    acc: null,
                    pass: null,
                    errore2: false,
                }
            },
            props: ['link'],
            template:
                '            <div class="container h-100">\n' +
                '                <div class="d-flex justify-content-center h-100">\n' +
                '                    <div class="user_card">\n' +
                '                        <div class="d-flex justify-content-center">\n' +
                '                            <div class="brand_logo_container">\n' +
                '                                <img src="img/logo.jpg" class="brand_logo" alt="Logo">\n' +
                '                            </div>\n' +
                '                        </div>\n' +
                '                        <div class="d-flex justify-content-center form_container">\n' +
                '                            <article class="form-group">\n' +
                '                                <div class="input-group mb-3">\n' +
                '                                    <div class="input-group-append">\n' +
                '                                        <span class="input-group-text"><i class="fas fa-user"></i></span>\n' +
                '                                    </div>\n' +
                '                                    <input v-model="em" type="text" class="form-control input_user" placeholder="Email">\n' +
                '                                </div>\n' +
                '                                <div class="input-group mb-3">\n' +
                '                                    <div class="input-group-append">\n' +
                '                                        <span class="input-group-text"><i class="fas fa-user"></i></span>\n' +
                '                                    </div>\n' +
                '                                        <input v-model="acc" type="text" class="form-control input_user" placeholder="Account">\n' +
                '                                </div>\n' +
                '                                <div class="input-group mb-2">\n' +
                '                                    <div class="input-group-append">\n' +
                '                                        <span class="input-group-text"><i class="fas fa-key"></i></span>\n' +
                '                                    </div>\n' +
                '                                        <input v-model="pass" type="password" class="form-control input_pass" placeholder="Password">\n' +
                '                                </div>\n' +
                '                                <div class="d-flex justify-content-center mt-3 login_container">\n' +
                '                                    <button v-on:click="ServletControllerPost(\'crea\')" class="btn login_btn">Crea account </button>\n' +
                '                                </div>\n' +
                '                                <div class="d-flex justify-content-center mt-3 login_container">\n' +
                '                                    <button v-on:click="transit(\'loginHome\')" class="btn login_btn">Annulla creazione</button>\n' +
                '                                </div>\n' +
                '                                <template v-if="errore2">\n' +
                '                                    <span class="badge badge-danger">Errore nei dati, ricontrolla e riprova. Grazie</span>\n' +
                '                                </template>\n' +
                '                            </article>\n' +
                '                        </div>\n' +
                '                    </div>\n' +
                '                </div>\n' +
                '            </div>',
            methods: {
                ServletControllerPost: function (flag){
                    var self = this;
                    $.post(this.link, {action: flag, email: this.em, account: this.acc, password: this.pass}, function (data) {
                        switch (data) {
                            case 'crea':
                                self.em = self.acc = self.pass = null; self.errore2 = false; alert('Successo: Account creato'); self.transit('loginHome'); break;
                            case 'errore2':
                                self.errore2 = true; break;
                        }
                    })
                },
                transit: function (flag) {
                    switch (flag){
                        case "loginHome":
                            this.$emit('transit-inner-login'); break;
                    }
                },
            }
        })

        //Component gestione corsi/docenti
        Vue.component('admincoursesteacher',{
            data: function () {
                return{
                    corsi: [],
                    docenti:[],
                    corsii: [],
                    docentii:[],
                    corsidocenti:[],
                    courses: null,
                    teacher: null,
                    coursess: null,
                    teacherr: null,
                }
            },
            props: ['link'],
            template: '         <div>\n' +
                '                   <div class="blocco">\n'+
                '                      <h4>Aggiunta di corsi e docenti affiliati</h4>\n' +
                '                        <p>-Hai la possibilit&aacute; di aggiungere un nuovo corso, un nuovo docente e creare la loro affiliazione.</p>\n' +
                '                        <div class="form-group">\n' +
                '                            <label for="aggiungiCorso">Aggiungi il corso:&nbsp&nbsp&nbsp&nbsp\n' +
                '                                <input v-model="courses" id="aggiungiCorso" type="text"  placeholder="Nome" required>\n' +
                '                            </label><br>\n' +
                '                            <label for="aggiungiDocente">Aggiungi il docente:\n' +
                '                                <input v-model="teacher" id="aggiungiDocente" type="text" placeholder="Nome e Cognome" required>\n' +
                '                            </label>\n' +
                '                            <br>\n' +
                '                            <div class="d-grid gap-2">\n' +
                '                                <button class="btn btn-primary" v-on:click="ServletControllerPost(\'Corsi_Docenti\', \'Aggiunta\')">Conferma dati</button>\n' +
                '                            </div>\n' +
                '                         </div>\n' +
                '                         <hr>\n'+
                '                        <h4>Affiliare corsi e docenti gi&agrave; presenti.</h4>\n' +
                '                        <div class="form-group">\n' +
                '                            <label>Docente\n' +
                '                                <select v-model="teacherr">\n' +
                '                                    <option v-for="co_do in docentii">{{co_do.nome}} {{co_do.cognome}}</option>\n' +
                '                                </select>\n' +
                '                            </label><br>\n' +
                '                            <label>Corso&nbsp&nbsp&nbsp&nbsp\n' +
                '                                <select v-model="coursess">\n' +
                '                                    <option v-for="co_do in corsii">{{co_do.titolo}}</option>\n' +
                '                                </select>\n' +
                '                            </label><br>\n' +
                '                            <br>\n' +
                '                            <div class="d-grid gap-2">\n' +
                '                                <button class="btn btn-primary" v-on:click="ServletControllerPost(\'Corsi_Docenti\', \'Affiliare\')">Conferma dati</button>\n' +
                '                            </div>\n' +
                '                           </div>'+
                '                        </div>'+
                '                       <div class="blocco2">\n'+
                '                        <h4>Rimozione di corsi e docenti</h4>\n' +
                '                        <p>-Hai la possibilit&aacute; di rimuovere un docente o un corso con le loro affiliazioni. Solo se non compaiono in nessuna prenotazioni attiva.</p>\n' +
                '                        <p>Seleziona il docente e il corso da rimuovere.</p>\n' +
                '                        <table class="tabellaDocenti">\n' +
                '                            <thead>\n' +
                '                                <tr><td><i><b>DOCENTI</b></i></td><td><i><b>OPERAZIONE</b></i></td></tr>\n' +
                '                            </thead>\n' +
                '                            <tbody>\n' +
                '                                <template v-for="docente in docenti">\n' +
                '                                    <tr><td>{{docente.nome}}</td><td><button class="btn btn-danger" v-on:click="ServletControllerPost(\'Corsi_Docenti\', docente.nome, \'docente\')">Rimuovi</button></td></tr>\n' +
                '                                </template>\n' +
                '                            </tbody>\n' +
                '                        </table>\n' +
                '                        <table class="tabellaCorsi">\n' +
                '                            <thead>\n' +
                '                                <tr><td><i><b>CORSO</b></i></td><td><i><b>OPERAZIONE</b></i></td></tr>\n' +
                '                            </thead>\n' +
                '                            <tbody>\n' +
                '                                <template v-for="corso in corsi">\n' +
                '                                    <tr><td>{{corso.titolo}}</td><td><button class="btn btn-danger" v-on:click="ServletControllerPost(\'Corsi_Docenti\', corso.titolo, \'corso\')">Rimuovi</button></td></tr>\n' +
                '                                </template>\n' +
                '                            </tbody>\n' +
                '                        </table>\n' +
                '                        <table class="tabellaCorsiDocenti">\n' +
                '                            <thead>\n' +
                '                                <tr><td><i><b>CORSO</b></i></td><td><i><b>DOCENTE</b></i></td><td><i><b>OPERAZIONE</b></i></td></tr>\n' +
                '                            </thead>\n' +
                '                            <tbody>\n' +
                '                                <template v-for="c_d in corsidocenti">\n' +
                '                                    <tr><td>{{c_d.corso}}</td><td>{{c_d.docente}}</td><td><button class="btn btn-danger" v-on:click="ServletControllerPost(\'Corsi_Docenti\', c_d.corso, c_d.docente)">Rimuovi</button></td></tr>\n' +
                '                                </template>\n' +
                '                            </tbody>\n' +
                '                        </table>\n' +
                '                       </div>\n'+
                '                    </div>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    $.get(this.link, {action: 'Corsi_Docenti', action2: 'Free'}, function (data) {
                        if(data === 0) {
                            self.transit();
                        }
                        self.corsidocenti = data;
                    });
                    $.get(this.link, {action: 'Corsi', action2: ''}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.corsii = data;
                    });
                    $.get(this.link, {action: 'Docenti', action2: ''}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.docentii = data;
                    })

                    $.get(this.link, {action: 'Corsi', action2: 'Free'}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.corsi = data;
                    });
                    $.get(this.link, {action: 'Docenti', action2: 'Free'}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.docenti = data;
                    })
                },
                ServletControllerPost: function (flag, flag2, flag3){
                    var self = this;
                    $.post(this.link, {action: flag, action2: flag2, action3 : flag3, corsi: this.courses, nome: this.teacher, corsii: this.coursess, nomee: this.teacherr}, function (data) {
                        switch (flag){
                            case "Corsi_Docenti":
                                if(data === "errore"){
                                    self.transit('alert');
                                }else if(data === "aggiunto" || data === "rimossa"){
                                    self.transit('gestioneCD');
                                }else if(data === 0) {
                                    self.transit('logout');
                                }
                                break;

                        }
                    })
                },
                transit: function (flag) {
                    switch (flag){
                        case "gestioneCD":
                            this.coursess = this.teacherr = this.courses = this.teacher = null; this.getDati(); break;
                        case "alert":
                            alert('Errore! Riprovare!'); break;
                        case "logout":
                            this.$emit('transit-inner-logout'); break;
                    }
                },
            }
        })

        //Component gestione ripetizioni
        Vue.component('adminrepetition',{
            data: function () {
                return {
                    ripetizionii: [],
                    corsi: [],
                    docenti: [],
                    courses: null,
                    teacher: null,
                    day: null,
                    hour: null,
                }
            },
            props: ['link'],
            template: '<div>\n' +
                '                     <div class="blocco">\n' +
                '                        <h4>Aggiunta di nuove ripetizioni</h4>\n' +
                '                        <p>-Scegli il docente, il corso, la data e l\'ora della ripetizione.</p>\n' +
                '                        <div class="form-group">\n' +
                '                            <label>Docente\n' +
                '                                <select v-model="teacher">\n' +
                '                                    <option v-for="co_do in docenti">{{co_do.nome}} {{co_do.cognome}}</option>\n' +
                '                                </select>\n' +
                '                            </label><br>\n' +
                '                            <label>Corso&nbsp&nbsp&nbsp&nbsp\n' +
                '                                <select v-model="courses">\n' +
                '                                    <option v-for="co_do in corsi">{{co_do.titolo}}</option>\n' +
                '                                </select>\n' +
                '                            </label><br>\n' +
                '                            <label>Data&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp\n' +
                '                                <select v-model="day">\n' +
                '                                    <option>Lunedi</option>\n' +
                '                                    <option>Martedi</option>\n' +
                '                                    <option>Mercoledi</option>\n' +
                '                                    <option>Giovedi</option>\n' +
                '                                    <option>Venerdi</option>\n' +
                '                                </select>\n' +
                '                            </label><br>\n' +
                '                            <label>Ora&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp\n' +
                '                                <select v-model="hour">\n' +
                '                                    <option>15:00/16:00</option>\n' +
                '                                    <option>16:00/17:00</option>\n' +
                '                                    <option>17:00/18:00</option>\n' +
                '                                    <option>18:00/19:00</option>\n' +
                '                                </select>\n' +
                '                            </label>\n' +
                '                                <br>\n' +
                '                                <div class="d-grid gap-2">\n' +
                '                                    <button class="btn btn-primary" v-on:click="ServletControllerPost(\'Ripetizioni\', \'\')">Conferma dati</button>\n' +
                '                                </div>\n' +
                '                            </div>\n' +
                '                            </div>\n' +
                '                        <div class="blocco2">\n' +
                '                            <h4>Rimozione delle ripetizioni</h4>\n' +
                '                            <p>-Hai la possibilit&aacute; di rimuovere una ripetizione. Solo se non &eacute; attiva, cio&eacute; gi&aacute; prenotata da un cliente.</p>\n' +
                '                        <table>\n' +
                '                            <thead>\n' +
                '                                <tr><td><i><b>CODICE</b></i></td><td><i><b>DOCENTE</b></i></td><td><i><b>CORSO</b></i></td><td><i><b>GIORNO</b></i></td><td><i><b>ORE</b></i></td><td><i><b>OPERAZIONE</b></i></td></tr>\n' +
                '                            </thead>\n' +
                '                            <tbody>\n' +
                '                                <template v-for="ripetizioni in ripetizionii">\n' +
                '                                    <tr><td>{{ripetizioni.codice}}</td><td>{{ripetizioni.docente}}</td><td>{{ripetizioni.corso}}</td><td>{{ripetizioni.giorno}}</td><td>{{ripetizioni.ora}}</td><td><button class="btn btn-danger" v-on:click="ServletControllerPost(\'Rimuovi\', ripetizioni.codice)">Rimuovi</button></td></tr>\n' +
                '                                </template>\n' +
                '                            </tbody>\n' +
                '                        </table>\n' +
                '                       </div>' +
                '                    </div>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    $.get(this.link, {action: 'Corsi', action2: ''}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.corsi = data;
                    });
                    $.get(this.link, {action: 'Docenti', action2: ''}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.docenti = data;
                    });
                    $.get(this.link, {action: 'RipetizioniA', action2: ''}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.ripetizionii = data;
                    })
                },
                ServletControllerPost: function (flag, flag2){
                    var self = this;
                    $.post(this.link, {action: flag, action2: flag2, corsi: this.courses, nome: this.teacher, giorno: this.day, ora: this.hour}, function (data) {
                        if(data === "errore") {
                            self.transit('alert');
                        }else if(data === 0){
                            self.transit("logout");
                        }else{
                            self.transit('gestioneR');
                        }
                    })
                },
                transit: function (flag) {
                    switch (flag){
                        case "gestioneR":
                            this.courses = this.teacher = this.hour = this.day = null; this.getDati(); break;
                        case "alert":
                            alert('Errore! Riprovare, controllare tutti i campi!'); break;
                        case "logout":
                            this.$emit('transit-inner-logout'); break;
                    }
                },
            }
        })

        //Component stampa dei corsidocenti
        Vue.component('coursesteacher',{
            data: function () {
                return{
                    corsidocenti: [],
                }
            },
            props: ['link'],
            template: '<table>\n' +
                '           <thead>\n' +
                '             <tr><td><i><b>CORSO</b></i></td><td><i><b>DOCENTE</b></i></td></tr>\n' +
                '           </thead>\n' +
                '           <tbody>\n' +
                '                 <template v-for="co_do in corsidocenti">\n' +
                '                       <tr v-if="co_do.stato === \'ATTIVO\'"><td>{{co_do.corso}}</td><td>{{co_do.docente}}</td></tr>\n' +
                '                 </template>\n' +
                '           </tbody>\n' +
                '        </table>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    $.get(this.link, {action: 'Corsi_Docenti', action2: 'all'}, function (data) {
                        if(data === 0) {
                            self.transit();
                        }
                        self.corsidocenti = data;
                    })
                },
                transit: function () {
                    this.$emit('transit-inner-logout');
                }
            }
        })

        //Component stampa dei corsi
        Vue.component('courses',{
            data: function () {
                return{
                    corsii: [],
                }
            },
            props: ['link', 'storico'],
            template: '<table class="tabellastorico">\n' +
                '            <thead>\n' +
                '                <tr><td><i><b>CORSI</b></i></td><td><i><b>STATO</b></i></td></tr>\n' +
                '             </thead>\n' +
                '             <tbody>\n' +
                '                <template v-for="corso in corsii">\n' +
                '                   <tr><td>{{corso.titolo}}</td><td v-if="corso.stato === \'RIMOSSO\'"><span class="badge rounded-pill bg-warning">{{corso.stato}}</span></td><td v-else><span class="badge bg-light text-dark">{{corso.stato}}</span></td></tr>\n' +
                '                 </template>\n' +
                '              </tbody>\n' +
                '      </table>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    if(this.storico === 'True'){
                        $.get(this.link, {action: 'Corsi', action2: 'storico'}, function (data) {
                            if(data === 0)
                                self.transit();
                            self.corsii = data;
                        })
                    }else {
                        $.get(this.link, {action: 'Corsi'}, function (data) {
                            if(data === 0)
                                self.transit();
                            self.corsii = data;
                        })
                    }
                },
                transit: function () {
                    this.$emit('transit-inner-logout');
                }
            }
        })

        //Component stampa dei docenti
        Vue.component('teacher',{
            data: function () {
                return{
                    docentii: [],
                }
            },
            props: ['link', 'storico'],
            template: '<table class="tabellastorico">\n' +
                '            <thead>\n' +
                '                <tr><td><i><b>DOCENTI</b></i></td><td><i><b>STATO</b></i></td></tr>\n' +
                '             </thead>\n' +
                '             <tbody>\n' +
                '                <template v-for="docente in docentii">\n' +
                '                   <tr><td>{{docente.nome}}</td><td v-if="docente.stato === \'RIMOSSO\'"><span class="badge rounded-pill bg-warning">{{docente.stato}}</span></td><td v-else><span class="badge bg-light text-dark">{{docente.stato}}</span></td></tr>\n' +
                '                </template>\n' +
                '              </tbody>\n' +
                '      </table>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    if(this.storico === 'True'){
                        $.get(this.link, {action: 'Docenti', action2: 'storico'}, function (data) {
                            if(data === 0)
                                self.transit();
                            self.docentii = data;
                        })
                    }else{
                        $.get(this.link, {action: 'Docenti',}, function (data) {
                            if(data === 0)
                                self.transit();
                            self.docentii = data;
                        })
                    }
                },
                transit: function () {
                    this.$emit('transit-inner-logout');
                },
            }
        })

        //Component stampa delle ripetizioni storico
        Vue.component('repetitionstorico',{
            data: function () {
                return{
                    ripetizionis: [],
                }
            },
            props: ['link'],
            template: '<table class="tabellastorico">\n' +
                '            <thead>\n' +
                '                <tr><td><i><b>CODICE</b></i></td><td><i><b>DOCENTE</b></i></td><td><i><b>CORSO</b></i></td><td><i><b>GIORNO</b></i></td><td><i><b>ORE</b></i></td><td><i><b>STATUS</b></i></td></tr>\n' +
                '            </thead>\n' +
                '       <tbody>' +
                '           <template v-for="ripetizioni in ripetizionis">\n' +
                '               <tr><td>{{ripetizioni.codice}}</td><td>{{ripetizioni.docente}}</td><td>{{ripetizioni.corso}}</td><td>{{ripetizioni.giorno}}</td><td>{{ripetizioni.ora}}</td><td v-if="ripetizioni.status === \'RIMOSSA\'"><span class="badge rounded-pill bg-warning">{{ripetizioni.status}}</span></td><td v-else><span class="badge bg-light text-dark">{{ripetizioni.status}}</span></td></tr>\n' +
                '           </template>\n' +
                '      </tbody>\n' +
                '      </table>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    $.get(this.link, {action: 'Ripetizioni', action2: 'storico'}, function (data) {
                        if(data === 0)
                            self.transit();
                        self.ripetizionis = data;
                    })
                },
                transit: function () {
                    this.$emit('transit-inner-logout');
                },
            }
        })

        //Component stampa delle ripetizioni
        Vue.component('repetition',{
            data: function () {
                return{
                    ripetizionii: [],
                }
            },
            props: ['link', 'ospite'],
            template: '<table>\n' +
                '            <thead>\n' +
                '                <tr><td v-if="ospite === \'False\'"><i><b>CODICE</b></i></td><td><i><b>DOCENTE</b></i></td><td><i><b>CORSO</b></i></td><td><i><b>GIORNO</b></i></td><td><i><b>ORE</b></i></td><td v-if="ospite === \'False\'"><i><b>STATUS</b></i></td><td v-if="ospite === \'False\'"><i><b>OPERAZIONE</b></i></td></tr>\n' +
                '            </thead>\n' +
                '       <tbody>' +
                '           <template v-for="ripetizioni in ripetizionii">\n' +
                '               <tr v-if="ripetizioni.status === \'DISPONIBILE\'"><td v-if="ospite === \'False\'">{{ripetizioni.codice}}</td><td>{{ripetizioni.docente}}</td><td>{{ripetizioni.corso}}</td><td>{{ripetizioni.giorno}}</td><td>{{ripetizioni.ora}}</td><td v-if="ospite === \'False\'"><span class="badge bg-light text-dark">{{ripetizioni.status}}</span></td><td v-if="ospite === \'False\'"><button class="btn btn-primary" v-on:click="ServletControllerPost(\'Prenota\', ripetizioni.codice)">Prenota</button></td></tr>\n' +
                '           </template>\n' +
                '      </tbody>\n' +
                '      </table>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    $.get(this.link, {action: 'Ripetizioni', action2:'stampa'}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.ripetizionii = data;
                    })
                },
                ServletControllerPost: function (flag, flag2){
                    var self = this;
                    $.post(this.link, {action: flag, action2: flag2}, function (data) {
                        switch (flag){
                            case "Prenota":
                                if(data === "errore"){
                                    self.transit('alert');
                                }else if(data === "aggiunta"){
                                    self.errore2 = false; self.transit('ripetizioni');
                                }else if(data === 0) {
                                    self.transit("logout");break;
                                }
                        }
                    })
                },
                transit: function (flag) {
                    switch (flag){
                        case "ripetizioni":
                            this.ripetizionii = true; this.getDati(); break;
                        case "alert":
                            alert('Errore! Riprovare!'); break;
                        case "logout":
                            this.$emit('transit-inner-logout'); break;
                    }
                },
            }
        })

        //Component stampa delle prenotazioni
        Vue.component('booking',{
            data: function () {
                return{
                    prenotazionii: [],
                }
            },
            props: ['link'],
            template: '<table>\n' +
                '           <thead>\n' +
                '               <tr><td><i><b>MATR.UTENTE</b></i></td><td><i><b>CODICE</b></i></td><td><i><b>DOCENTE</b></i></td><td><i><b>CORSO</b></i></td><td><i><b>GIORNO</b></i></td><td><i><b>ORE</b></i></td><td><i><b>STATUS</b></i></td></tr>\n' +
                '           </thead>\n' +
                '           <tbody>\n' +
                '               <template v-for="prenotazioni in prenotazionii">\n' +
                '                   <tr><td>{{prenotazioni.utente}}</td><td>{{prenotazioni.codice}}</td><td>{{prenotazioni.docente}}</td><td>{{prenotazioni.corso}}</td><td>{{prenotazioni.giorno}}</td><td>{{prenotazioni.ora}}</td><td v-if="prenotazioni.status === \'RIMOSSA\'"><span class="badge rounded-pill bg-danger">{{prenotazioni.status}}</span><td v-if="prenotazioni.status === \'EFFETTUATA\'"><span class="badge bg-warning text-dark">{{prenotazioni.status}}</span></td><td v-if="prenotazioni.status === \'ATTIVA\'"><span class="badge badge-success">{{prenotazioni.status}}</span></td></tr>\n' +
                '               </template>\n' +
                '           </tbody>\n' +
                '      </table>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    $.get(this.link, {action: 'Prenotazioni'}, function (data) {
                            if(data === 0)
                                self.transit();
                            self.prenotazionii = data;
                    })
                },
                transit: function () {
                    this.$emit('transit-inner-logout');
                },
            },
        })

        //Component stampa delle mie prenotazioni
        Vue.component('mybooking',{
            data: function () {
                return{
                    myprenotazioni: [],
                }
            },
            props: ['link'],
            template: '<table>\n' +
                '           <thead>\n' +
                '               <tr><td><i><b>CODICE</b></i></td><td><i><b>DOCENTE</b></i></td><td><i><b>CORSO</b></i></td><td><i><b>GIORNO</b></i></td><td><i><b>ORE</b></i></td><td><i><b>STATUS</b></i></td><td><i><b>OPERAZIONE</b></i></td></tr>\n' +
                '           </thead>\n' +
                '           <tbody>\n' +
                '               <template v-for="prenotazioni in myprenotazioni">\n' +
                '                   <tr><td>{{prenotazioni.codice}}</td><td>{{prenotazioni.docente}}</td><td>{{prenotazioni.corso}}</td><td>{{prenotazioni.giorno}}</td><td>{{prenotazioni.ora}}</td><td v-if="prenotazioni.status === \'RIMOSSA\'"><span class="badge rounded-pill bg-danger">{{prenotazioni.status}}</span></td><td v-if="prenotazioni.status === \'EFFETTUATA\'"><span class="badge bg-warning text-dark">{{prenotazioni.status}}</span></td><td v-if="prenotazioni.status === \'ATTIVA\'"><span class="badge badge-success">{{prenotazioni.status}}</span></td><td v-if="prenotazioni.status === \'RIMOSSA\'"><button class="btn btn-primary" v-on:click="ServletControllerPost(\'Riprenota\', prenotazioni.codice)">Prenota</button></td><td v-if="prenotazioni.status === \'ATTIVA\'"><button class="btn btn-danger" v-on:click="ServletControllerPost(\'Disdetta\', prenotazioni.codice)">Rimuovi</button><br><br><button class="btn btn-primary" v-on:click="ServletControllerPost(\'Effettuata\', prenotazioni.codice)">Effettuata</button></td></tr>\n' +
                '               </template>\n' +
                '           </tbody>\n' +
                '      </table>',
            mounted(){
                this.getDati();
            },
            methods: {
                getDati: function (){
                    var self = this;
                    $.get(this.link, {action: 'MiePrenotazioni'}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.myprenotazioni = data;
                    })
                },
                ServletControllerPost: function (flag, flag2){
                    var self = this;
                    $.post(this.link, {action: flag, action2: flag2,}, function (data) {
                        if(data === 0)
                            self.transit("logout");
                        self.transit("dati");
                    })
                },
                transit: function (flag) {
                    switch (flag){
                        case "dati":
                            this.getDati();break;
                        case "logout":
                            this.$emit('transit-inner-logout'); break;
                    }
                },
            },
        })

        //home di ospite/cliente/amministratore
        Vue.component('home',{
            template:
                '<article class="container">' +
                '    <br><br>' +
                '        <h5>Scegli l&rsquo;opzione che desideri.</h5>\n' +
                '            <br>\n' +
                '            <button class="botton" v-on:click="transitCorsi_Docenti"><img src="img/lista.png" width="280" height="280" alt><br> Visualizza corsi e docenti</button>\n' + '&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp'+
                '            <button class="botton" v-on:click="transitRipetizioni"><img src="img/prenotazionecortisonici2020-1.png" width="280" height="280" alt><br>Prenota le tue lezioni</button>\n' + '&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp'+
                '            <button class="botton" v-on:click="transitPrenotazioni"> <img src="img/docentecorso.png" height="280" width="280" alt> <br>Le  mie prenotazioni</button>\n' +
                '</article>',
            methods: {
                transitPrenotazioni: function () {
                    this.$emit('transit-inner-prenotazioni');
                },
                transitRipetizioni: function () {
                    this.$emit('transit-inner-ripetizioni');
                },
                transitCorsi_Docenti: function (){
                    this.$emit('transit-inner-corsi_docenti');
                }
            }
        })

        var app = new Vue ({
            el: '#components',
            data: {
                /*SEZIONE LOGIN*/               loginHome: true, em: null, acc: null, pass: null, role: 'Ospite', errore: false,
                /*SEZIONE HOME AMMINISTRATORE*/ homeAmministratore: false, errore2: false, checkAH: false, gestioneCD: false, gestioneR: false, storico: false, stampaPr: false,
                /*SEZIONE HOME OSPITE*/         homeOspite: false, checkO: false,
                /*SEZIONE HOME CLIENTE*/        homeCliente: false, checkCl: false, stampaCD: false, stampaR: false, stampaMPr: false,
                /*SEZIONE CREAZIONE*/           creazionehome: false,
                link: 'ServletController'
            },
            methods: {
                //ServletController, gestisce le Servlet che uso per effettuare il logout
                ServletControllerPost: function (flag){
                    var self = this;
                    $.post(this.link, {action: flag}, function (data) {
                        self.em = self.pass = null; alert('Attenzione: Logout effettuato. Stai tornando al login'); self.transit("loginHome");
                    })
                },

                //Funzione per il transito da pagina a pagina e per la stampa degli oggetti Json
                transit: function (flag) {
                    switch (flag){
                        case "creazione":
                            this.creazionehome = true; this.loginHome = this.errore2 = false; this.em = this.pass = null; break;
                        case "ospiteHome":
                            this.role = 'Ospite'; this.homeOspite = this.checkO = true; this.loginHome = this.stampaR = this.stampaCD = false; break;
                        case "logout":
                            this.ServletControllerPost("logout", ''); break;
                        case "logout2":
                            this.em = this.pass = null; alert('Attenzione: Sessione scaduta. Stai tornando al login'); this.transit("loginHome"); break;
                        case "loginHome":
                            this.loginHome = true; this.homeAmministratore = this.creazionehome = this.homeOspite = this.homeCliente = this.checkO = this.errore2 = false; break;
                        case "amministratoreHome":
                            this.role = 'Amministratore'; this.homeAmministratore = this.checkAH = true; this.storico = this.loginHome = this.stampaPr = this.stampaMPr = this.stampaR = this.stampaCD = this.gestioneCD = this.gestioneR = this.errore2 = false; break;
                        case "clienteHome":
                            this.role = 'Cliente'; this.homeCliente = this.checkCl = true; this.loginHome = this.stampaMPr = this.stampaR = this.stampaCD = false; break;
                        case "gestioneCD":
                            this.gestioneCD = true; this.storico = this.stampaCD = this.checkAH = this.gestioneR = this.errore2 = this.stampaMPr = this.stampaR = this.stampaPr = false; break;
                        case "gestioneR":
                            this.gestioneR = true; this.storico = this.checkAH = this.stampaCD = this.gestioneCD = this.stampaMPr = this.stampaR = this.stampaPr = this.errore2 = false; break;
                        case "corsi_docenti":
                            this.stampaCD = true;  this.storico = this.checkCl = this.checkAH = this.checkO = false; break;
                        case "ripetizioni":
                            this.stampaR = true; this.stampaCD = false; this.storico = this.checkCl = this.checkAH = this.checkO = this.stampaPr = this.stampaMPr = this.gestioneCD = this.gestioneR = false; break;
                        case "prenotazioni":
                            this.stampaPr = true;  this.storico = this.checkCl = this.checkAH = this.checkO = this.stampaCD = this.gestioneR = this.gestioneCD = this.stampaMPr = this.stampaR = false; break;
                        case "mieprenotazioni":
                            this.stampaMPr = true; this.stampaCD = this.storico = this.checkCl = this.checkAH = this.checkO = this.stampaPr = this.stampaR = this.gestioneCD = this.gestioneR = false; break;
                        case "storico":
                            this.storico = true; this.gestioneCD = this.stampaCD = this.checkAH = this.gestioneR = this.errore2 = this.stampaMPr = this.stampaR = this.stampaPr = false; break;
                        case "alert":
                            alert('Non hai prenotazioni. Sei un ospite!');
                    }
                },
            }
        })

    </script>
    <!--<div id="push"> </div>
    <footer id="footer">
        <p class="foot"><i><b>Corso Interazione Uomo/Macchina 2021/2022</b></i></p>
        <p class="foot"><i><b>Sisinni Daniele 914874</b></i></p>
    </footer>-->
</body>
</html>


