<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="Cache-Control" content="no-store" />
    <title>Booking</title>

    <link href="bootstrap-4.5.2-dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="bootstrap-4.5.2-dist/js/jquery-slim.min.js"></script>
    <script src="bootstrap-4.5.2-dist/js/bootstrap.min.js"></script>
    <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">-->

</head>
<body> <!--class="d-flex justify-content-center"-->
    <div id="components">
        <span v-if="loginHome">
            <testa></testa>
            <article class="text-center">
                <hr><h4>Applicazione delle prenotazioni - Unito</h4><hr>
                <br>
                    <p>Amministratore - Cliente</p>
                    <p>Account : <input v-model="acc" type="text" required></p>
                    <p>Password : <input v-model="pass" type="password"  required></p>

                    <button v-on:click="ServletController('login')">Autentica </button>
                    <template v-if="checkA">
                        <span class="badge badge-success">Successo</span>
                        <br>
                        <p>Benvenuto {{ acc }} [Amministratore]</p>
                    </template>
                    <template v-if="check">
                        <span class="badge badge-success">Successo</span>
                        <br>
                        <p>Benvenuto {{ acc }} [Cliente]</p>
                    </template>
                <template v-if="checkE">
                    <span class="badge badge-danger">Errore nel login</span>
                </template>
                <br><br><br><br><br>
                <hr>
            </article>
            <centro-login v-on:ospite-inner="ServletController('ospite')" v-on:creazione-inner="transit('creazione')" class="text-center" ></centro-login>
        </span>

        <span v-if="creazionehome">
            <testa title="Benvenuto"></testa>
            <article class="container">
                <br>
                    <ul>
                        <li>
                            Benvenuto nell'area di registrazione. Crea il tuo account
                        </li>
                    </ul>
                <form>
                    <p>Account:  <input v-model="acc" type="text" required placeholder="account"/></p>
                    <p>Password: <input v-model="pass" type="password" required placeholder="password"/></p>
                </form>
                    <button v-on:click="ServletController('crea')">Crea account </button>
                    <template v-if="checkC">
                        <p>Cliente Benvenuto!</p>
                        <p><span class="badge badge-success">Successo</span> Account creato</p>
                    </template>
                    <template v-if="errore2">
                        <span class="badge badge-danger">Errore nei dati, ricontrolla e riprova. Grazie</span>
                    </template>
            </article>
        </span>

        <span v-if="homeCliente">
            <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
                <div class="container-fluid">
                    <a class="navbar-brand" href="https://www.unito.it/">UniTO</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" aria-current="page" type="button" v-on:click="transit('clienteHome')">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Prenotazioni</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Ripetizioni</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <home v-if="checkCl" v-on:transit-inner-prenotazioni="transit('prenotazioni')" v-on:transit-inner-docenti="transit('docenti')" v-on:transit-inner-corsi_docenti="transit('corsi_docenti')" v-on:transit-inner-ripetizioni="transit('ripetizioni')" v-on:transit-inner-logout="transit('logout')"></home>
            <div v-if="stampaD" v-for="(docenti, index) in printD" class="container">
                <hr>
                <p>{{ index }}) - {{docenti.nome}}, {{docenti.cognome}}, {{docenti.iddocente}}</p>
            </div>
            <div v-if="stampaCD" class="container">
                <h4>Corsi...........Docenti</h4>
                <span v-for="co_do in printCD">
                    <hr>
                    <p>[{{co_do.corso}}]--[{{co_do.docente}}]</p>
                </span>
            </div>
            <div v-if="stampaR" v-for="ripetizioni in printR" class="container">
                <hr>
                <p>{{ripetizioni.docente}}, {{ripetizioni.corso}}, {{ripetizioni.data}}, {{ripetizioni.ora}}, {{ripetizioni.status}}</p>
            </div>
            <div class="container" v-if="logout" >
                <span class="badge bg-warning text-dark">Attenzione:</span>
                <p> Logout effettuato con successo</p>
            </div>
        </span>

        <span v-if="homeOspite">
            <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
                <div class="container-fluid">
                    <a class="navbar-brand" href="https://www.unito.it/">UniTO</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav2">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" aria-current="page" type="button" v-on:click="transit('ospiteHome')">Home</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <home v-if="checkO"  v-on:transit-inner-docenti="transit('docenti')" v-on:transit-inner-corsi_docenti="transit('corsi_docenti')" v-on:transit-inner-ripetizioni="transit('ripetizioni')" v-on:transit-inner-logout="transit('logout')"></home>
            <div v-if="stampaD" v-for="docenti in printD" class="container">
                <hr>
                <p>{{docenti.nome}}, {{docenti.cognome}}, {{docenti.iddocente}}</p>
            </div>
            <div v-if="stampaCD" class="container">
                <h4>Corsi...........Docenti</h4>
                <span v-for="co_do in printCD">
                    <hr>
                    <p>[{{co_do.corso}}]--[{{co_do.docente}}]</p>
                </span>
            </div>
            <div v-if="stampaR" v-for="ripetizioni in printR" class="container">
                <hr>
                <p>{{ripetizioni.docente}}, {{ripetizioni.corso}}, {{ripetizioni.data}}, {{ripetizioni.ora}}</p>
            </div>
            <div class="container" v-if="logout" >
                <span class="badge bg-warning text-dark">Attenzione:</span>
                <p> Logout effettuato con successo</p>
            </div>
        </span>

        <span v-if="homeAmministratore">
            <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
                <div class="container-fluid">
                    <a class="navbar-brand" href="https://www.unito.it/">UniTO</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav3">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" aria-current="page" type="button" v-on:click="transit('amministratoreHome')">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Prenotazioni attive</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Prenotazioni</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Ripetizioni</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <article v-if="checkAH" class="container">
                <br><br><h5>Scegli l'opzione che desideri</h5>
                <ul>
                    <li>
                        <button class="btn btn-outline-secondary" v-on:click="transit('prenotazioni')">Le prenotazioni attive</button>
                    </li>
                    <br>
                    <li>
                        <button class="btn btn-outline-secondary" v-on:click="transit('prenotazioni2')">Le  mie prenotazioni attive</button>
                    </li>
                    <br>
                    <li>
                        <button class="btn btn-outline-secondary" v-on:click="transit('docenti')">Visualizzare i docenti</button>
                    </li>
                    <br>
                    <li>
                        <button class="btn btn-outline-secondary" v-on:click="transit('corsi_docenti')">Visualizzare i corsi/docenti</button>
                    </li>
                    <br>
                    <li>
                        <button class="btn btn-outline-secondary" v-on:click="transit('ripetizioni')">Visualizzare le ripetizioni disponibili</button>
                    </li>
                    <br>
                    <li>
                        <button class="btn btn-outline-secondary" v-on:click="transit('aggCD')">Aggiungi corsi e docenti</button>
                    </li>
                    <br>
                    <li>
                        <button class="btn btn-outline-danger" v-on:click="transit('logout')">Logout</button>
                    </li>
                </ul>
            </article>

            <!--<home v-if="checkAH" v-on:transit-inner-prenotazioni="transit('prenotazioni')" v-on:transit-inner-docenti="transit('docenti')" v-on:transit-inner-corsi_docenti="transit('corsi_docenti')" v-on:transit-inner-ripetizioni="transit('ripetizioni')" v-on:transit-inner-logout="transit('logout')"></home>-->
            <br>
            <span v-if="stampaD" v-for="docenti in printD" class="container">
                <hr>
                <p>{{docenti.nome}}, {{docenti.cognome}}, {{docenti.iddocente}}</p>
            </span>
            <span v-if="stampaCD" class="container">
                <h4>Corsi...........Docenti</h4>
                <span v-for="co_do in printCD">
                    <hr>
                    <p>[{{co_do.corso}}]--[{{co_do.docente}}]</p>
                </span>
            </span>
            <span v-if="stampaR" v-for="ripetizioni in printR" class="container">
                <hr>
                <p>{{ripetizioni.docente}}, {{ripetizioni.corso}}, {{ripetizioni.data}}, {{ripetizioni.ora}}, {{ripetizioni.status}}</p>
            </span>
            <span v-if="logout" class="container">
                <span class="badge bg-warning text-dark">Attenzione:</span>
                <p> Logout effettuato con successo</p>
            </span>

            <article v-if="aggiungiCD" class="container">
                <h4>Aggiunta di corsi e docenti affliati</h4>
                <p>-Hai la possibilit&aacute; di aggiungere un nuovo corso, un nuovo docente e creare la loro affiliazione.</p>
                <br>

                <p>Aggiungi il corso:</p>
                <input v-model="corsi" type="text"  placeholder="Nome" required>

                <hr>
                <p>Aggiungi il docente:</p>
                <input v-model="var1" type="text" placeholder="Nome" required>
                <input v-model="var2" type="text" placeholder="Cognome" required>

                <br><br>
                <div class="d-grid gap-2">
                    <button class="btn btn-primary" v-on:click="createArray()">Conferma dati</button>
                </div>
            </article>
        </span>

    </div>

    <script>
        //VueLogin
        Vue.component('testa',{
            props: ['title'],
            template:'<header><h3 class="text-center">{{ title }}</h3><br></header>',
            methods: {
                logInner: function () {
                    this.$emit('log-inner');
                },
            }
        })
        Vue.component('centro-login',{
            template:'<article>' +
                    '     <p>Non hai ancora un account? <button type="button" class="btn btn-outline-info" v-on:click="creazioneInner"> Crea account</button>' +
                    '     Oppure entra come  <button type="button" class="btn btn-outline-info" v-on:click="ospiteInner">Ospite </button></p>' +
                    '</article>',
            methods: {
                creazioneInner: function (){
                    this.$emit('creazione-inner');
                },

                ospiteInner: function (){
                    this.$emit('ospite-inner');
                }
            }
        })

        //home di ospite/cliente/amministratore
        /*Vue.component('home',{
            template:
                '<article class="container">' +
                '    <br><br><h5>Scegli l\'opzione che desideri</h5>' +
                '            <ul>\n' +
                '            <li v-if="checkAH">\n' +
                '                <button class="btn btn-outline-secondary" v-on:click="transitPrenotazioni">Le prenotazioni attive</button>\n' +
                '            <br>\n' +
                '            </li>\n' +
                '            <li v-if="checkCL">\n' +
                '                <button class="btn btn-outline-secondary" v-on:click="transitPrenotazioni">Le  mie prenotazioni attive</button>\n' +
                '            <br>\n' +
                '            <br>\n' +
                '            </li>\n' +
                '            <li>\n' +
                '                <button class="btn btn-outline-secondary" v-on:click="transitDocenti">Visualizzare i docenti</button>\n' +
                '            </li>\n' +
                '            <br>\n' +
                '            <li>\n' +
                '                <button class="btn btn-outline-secondary" v-on:click="transitCorsi_Docenti">Visualizzare i corsi/docenti</button>\n' +
                '            </li>\n' +
                '            <br>\n' +
                '            <li>\n' +
                '                <button class="btn btn-outline-secondary" v-on:click="transitRipetizioni">Visualizzare le ripetizioni disponibili</button>\n' +
                '            </li>\n' +
                '            <br>\n' +
                '            <li>\n' +
                '                <button class="btn btn-outline-danger" v-on:click="transitLogout">Logout</button>\n' +
                '            </li>\n' +
                '       </ul>\n' +
                '</article>',
            methods: {
                transitPrenotazioni: function () {
                    this.$emit('transit-inner-prenotazioni');
                },
                transitDocenti: function () {
                    this.$emit('transit-inner-docenti');
                },
                transitRipetizioni: function () {
                    this.$emit('transit-inner-ripetizioni');
                },
                transitLogout: function () {
                    this.$emit('transit-inner-logout');
                },
                transitCorsi_Docenti: function (){
                    this.$emit('transit-inner-corsi_docenti');
                }
            }
        })*/


        let nome = null, cognome = null;
        var app = new Vue ({
            el: '#components',
            data: {
                loginHome: true, acc: null, pass: null, role: 'Ospite', check: false, checkA: false, checkE: false,
                homeAmministratore: false, logout: false, errore2: false, checkAH: false, aggiungiCD: false, corsi: null, var1: null, var2: null, docenti: [],
                homeOspite: false, checkO: false,
                homeCliente: false, checkCl: false, printCD: [], printD: [], printR: [], stampaCD: false, stampaD: false, stampaR: false,
                creazionehome: false, checkC: false, print: '',

                link: 'ServletController'
            },
            methods: {
                //ServletController, gestisce tutte le Servlet e passa i data che ottiene alle chiamate
                ServletController: function (flag){
                    var self = this;
                    $.post(this.link, {account: this.acc, password: this.pass, action: flag, courses: this.corsi, teacher: this.docenti}, function (data) {
                        //Sezione Servlet Login
                        if(flag === 'login' || flag === 'crea'|| flag === 'ospite'){
                            switch (data) {
                                case 'sono amministratore':
                                    self.role = 'Amministratore'; self.checkA = true; self.checkE = false; self.check = false;
                                    setTimeout(() => {
                                        self.transit("amministratoreHome");
                                    }, 2300);
                                    break;
                                case 'sono cliente':
                                    self.role = 'Cliente'; self.check = true; self.checkA = false; self.checkE = false;
                                    setTimeout(() => {
                                        self.transit("clienteHome");
                                    }, 2300);
                                    break;
                                case 'sono ospite':
                                    self.role = 'Ospite'; self.transit("ospiteHome");
                                    break;
                                case 'errore':
                                    self.check = false; self.checkA = false; self.checkE = true;
                                    break;
                                case 'crea':
                                    self.checkC = true; self.acc = null; self.pass = null; self.errore2 = false;
                                    setTimeout(() => {
                                        self.transit('loginHome');
                                    }, 2000);
                                    break;
                                case 'errore2':
                                    self.errore2 = true;
                                    break;
                                case 'ospite':
                                    self.role = 'Ospite'; self.transit("ospiteHome");
                                    break;
                            }
                            //Sezione Servlet/Docenti, stampa dei docenti per i clienti
                        }else if(flag === 'Docenti'){
                            self.printD = data;
                            //Sezione Servlet/Corsi_Docenti
                        }else if(flag === 'Corsi_Docenti'){
                            self.printCD = data;
                            //Sezione Servlet/Ripetizioni, stampa delle ripetizioni per i clienti
                        }else if(flag === 'Ripetizioni'){
                            self.printR = data;
                            //Sezione Servlet/Logout
                        }else if(flag === 'logout'){
                            self.logout = true; self.acc = null; self.pass = null;
                            setTimeout(() => {
                                self.transit("loginHome");
                            }, 2300);
                        }
                    })
                },

                createArray: function(){
                    console.log(this.var1);console.log(this.var2);
                    this.docenti.push(this.var1);this.docenti.push(this.var2);
                    console.log(this.docenti);
                    this.ServletController("Corsi_Docenti");
                },

                //Funzione per il transito da pagina a pagina e per la stampa degli oggetti Json
                transit: function (flag) {
                    if(flag === 'creazione') {
                        this.loginHome = false; this.creazionehome = true; this.errore2 = false;
                    }else if(flag === 'ospiteHome'){
                        this.loginHome = false; this.homeOspite = true; this.checkO = true; this.stampaD = false; this.stampaR = false; this.stampaCD = false;
                    }else if(flag === 'logout') {
                        this.ServletController("logout");
                    }else if(flag === 'loginHome') {
                        this.loginHome = true; this.homeAmministratore = false; this.creazionehome = false; this.homeCliente = false; this.logout = false; this.check = false; this.checkA = false; this.checkO = false; this.errore2 = false;
                    }else if(flag === 'amministratoreHome'){
                        this.loginHome = false; this.homeAmministratore = true; this.checkAH = true; this.stampaD = false; this.stampaR = false; this.stampaCD = false;
                    }else if(flag === 'clienteHome'){
                        this.loginHome = false; this.homeCliente = true; this.checkCl = true; this.stampaD = false; this.stampaR = false; this.stampaCD = false;
                    }else if(flag === 'aggCD'){
                        this.checkAH = false; this.aggiungiCD = true;
                    } else if(flag === 'corsi_docenti'){
                        this.checkCl = false; this.checkAH = false; this.checkO = false; this.stampaCD = true;
                        this.ServletController("Corsi_Docenti");
                    }else if(flag === 'docenti'){
                        this.checkCl = false; this.checkAH = false; this.checkO = false; this.stampaD = true; this.ServletController("Docenti");
                    }else if(flag === 'ripetizioni'){
                        this.checkCl = false; this.checkAH = false; this.checkO = false; this.stampaR = true; this.ServletController("Ripetizioni");
                    }
                },
            }
        })
    </script>
</body>
</html>

